import sys
import time
import urllib
import urllib2  
from urllib2 import *
from bs4 import BeautifulSoup
import re
import socket
import MySQLdb
import urlparse
import mechanize
import httplib
reload(sys)

sys.setdefaultencoding('utf-8')
               
def main():
	con=MySQLdb.connect(host='localhost',user='root',passwd='19941017')
        cur=con.cursor()
        con.select_db('practice')
	url="http://lg.atman.pl/"
        headers = ('User-Agent','Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11')
        opener = urllib2.build_opener()
        opener.addheaders = [headers]
        f=opener.open(url)
        soup=BeautifulSoup(f) 
        forms=soup.findAll('form')
	mid=670
        for form in forms:
           selects=form.findAll('select')
           for select in selects:		
		if select['name']=='router':
		    options=form.findAll('option')
 		    i=1
		    for option in options:			
		        value=(mid,i,option.next)
			cur.execute("INSERT into Detail values(%s,%s,%s)",value)
                	cur.execute("commit")
		   	print value,"has been written in DB!\n","--------------------------------------------"
		        i=i+1
        cur.close()
if __name__=='__main__':
    main()
